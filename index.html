<!doctype html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>JavaScript Microsoft Graph SPA</title>
  <link rel="icon" href="data:;base64,="> <!-- Suppress favicon error -->
  <link rel="stylesheet"
    href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body class="ms-Fabric" dir="ltr">
  <a id="signin" onclick="displayUI(); return false;" href="#">
    <img src="./images/ms-symbollockup_signin_light.png" alt="Sign in with Microsoft" />
  </a>
  <div id="content" style="display: none;">   
      <div class="card">
          <canvas class="header-bg"  height="70" id="header-blur"></canvas>
          <div class="avatar">
              <img id="myProfileImage" src="" alt="" />
          </div>
          <div class="about">
            <h1><span id="userName"></span></h1>
               <p id="myJob"></p>
          </div>    
  </div>
    <div class="ms-Grid">
      <div class="ms-Grid-row">
        <div class="ms-Grid-col ms-sm12 ms-md6 ms-lg4">

          <!-- Colleagues -->
          <div id="colleagues">
            <h2>Your colleagues</h2>
            <span class="loading">Loading colleagues...</span>
            <ul></ul>
          </div>

          <!-- Files -->
          <div id="trending">
            <h2>Trending files</h2>
            <span class="loading">Loading trending files...</span>
            <ul></ul>
          </div>
        </div>

        <!-- Email -->
        <div class="ms-Grid-col ms-sm12 ms-md6 ms-lg4">
          <div id="emails">
            <h2>Your unread emails</h2>
            <span class="loading">Loading unread emails...</span>
            <ul></ul>
          </div>
        </div>

        <!-- Events -->
        <div class="ms-Grid-col ms-sm12 ms-md6 ms-lg4">
          <div id="events">
            <h2>Upcoming meetings for next week</h2>
            <mgt-agenda group-by-day id="myMeetings">
              <template>
                <div class="details ms-depth-8" data-for="event in events">
                  <div>
                    <div class="subject ms-fontWeight-bold ms-color-sharedCyanBlue20">{{ event.subject }}</div>
                    <div class="date">{{ dayFromDateTime(event.start.dateTime) }}</div>
                    <div class="time">{{ timeRangeFromEvent(event) }}</div>
                  </div>
                 
                  <div class="location" data-if="event.location.displayName">
                    üìç
                    <a  href="https://bing.com/maps/default.aspx?where1={{event.location.displayName}}"
                      target="_blank"><b>{{ event.location.displayName }}</b></a>
                  </div>
                  <div class="attendees" data-if="event.attendees.length">
                    <span class="attendee" data-for="attendee in event.attendees">                       
                     <img src="{{attendee.personImage}}">
                    </span>
                  </div>
                  <div class="online-meeting" data-if="event.bodyPreview.includes('Join Microsoft Teams Meeting')">
                    <img class="online-meeting-icon" src="https://img.icons8.com/color/48/000000/microsoft-teams.png" />
                    <a class="online-meeting-link" href="{{ event.onlineMeetingUrl }}">Join Teams Meeting</a>
                  </div>
                </div>
              </template>
            </mgt-agenda>
            <p id="noMeetingMsg">It's quiet here üîï</p>
          </div>
        </div>
        
      </div>
    </div>
  </div>

  <script src="https://alcdn.msauth.net/browser/2.1.0/js/msal-browser.min.js"
    integrity="sha384-EmYPwkfj+VVmL1brMS1h6jUztl4QMS8Qq8xlZNgIT/luzg7MAzDVrRa2JxbNmk/e"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@microsoft/microsoft-graph-client/lib/graph-js-sdk.js"></script>
  <script src="https://unpkg.com/@microsoft/mgt@2.2.0-next.file.e40e43b/dist/bundle/mgt-loader.js"></script>
  <script src=".env.js"></script>
  <script src="auth.js"></script>
  <script src="graph.js"></script>
  <script src="ui.js"></script>
  <script src="date.js"></script>
  <script>
    displayUI(true);
  </script>
</body>

</html>